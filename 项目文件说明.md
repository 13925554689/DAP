# DAP系统 - 项目文件说明

## ✅ 系统确认

**界面类型**: **GUI界面** (基于Tkinter + TkinterDnD2)
- 图形用户界面,支持拖拽导入
- 专业的审计数据分析界面
- 类似金蝶/用友的财务报表查看器

---

## 📁 根目录文件结构 (已清理)

### 核心程序文件 (3个)

1. **main_engine.py** - DAP核心处理引擎
   - 五层架构的主引擎
   - 数据导入、清洗、存储、分析
   - 支持轻量模式和完整模式自动切换

2. **dap_launcher.py** - GUI启动器
   - Tkinter图形界面
   - 拖拽导入功能
   - 实时进度显示
   - 项目管理功能
   - 集成财务报表查看器入口

3. **gui_financial_viewer.py** - 财务报表查看器
   - 6种专业报表类型
   - 类似金蝶/用友界面
   - Excel导出功能
   - 解决凭证显示不全问题

### 启动脚本 (4个)

1. **start_gui.bat** - 启动GUI界面 (主要)
   ```bash
   python dap_launcher.py
   ```

2. **start_cli.bat** - 启动命令行模式
   ```bash
   python main_engine.py --cli
   ```

3. **install.bat** - 安装依赖
   ```bash
   pip install -r requirements.txt
   ```

4. **fix_dependencies.bat** - 修复依赖 (轻量模式)
   ```bash
   pip install rarfile openpyxl pandas pydantic
   ```

### 配置文件 (1个)

1. **requirements.txt** - Python依赖包列表
   - pandas, openpyxl, pydantic
   - tkinter, tkinterdnd2
   - rarfile (可选,完整模式)

### 文档文件 (4个)

1. **README.md** - 项目总文档
   - 项目概述和架构说明

2. **README_新功能使用指南.md** - 新功能使用指南 ⭐
   - 财务报表查看功能完整指南
   - 6种报表详解
   - 智能模式切换说明
   - 快速开始步骤
   - 常见问题解答

3. **CLAUDE.md** - Claude Code开发指南
   - 架构设计原则
   - 开发规范
   - API端点说明

4. **AGENTS.md** - AI Agent配置
   - Agent行为规则
   - 工作流程定义

---

## 🗑️ 已删除的文件

### 临时和测试文件
- ✅ `temp_todo.txt` - 临时待办事项
- ✅ `dap.log` - 日志文件(运行时会重新生成)
- ✅ `test_financial_viewer.py` - 测试脚本
- ✅ `cleanup_project.py` - 清理脚本

### GitHub备份相关文件 (不需要)
- ✅ `test_github_backup.py`
- ✅ `run_first_backup.py`
- ✅ `setup_github_repo.py`
- ✅ `auto_git_backup.py`
- ✅ `start_github_backup.py`
- ✅ `setup_github_backup.py`
- ✅ `test_github_backup.bat`
- ✅ `setup_github_backup.bat`
- ✅ `start_github_backup.bat`
- ✅ `deploy_github.bat`
- ✅ `start_auto_backup.bat`
- ✅ `stop_auto_backup.bat`
- ✅ `start_auto_backup_background.bat`
- ✅ `check_backup_status.bat`
- ✅ `GITHUB_BACKUP_README.md`
- ✅ `AUTO_BACKUP_README.md`

### 未使用的功能脚本
- ✅ `performance_monitor.py` - 性能监控
- ✅ `self_learning_manager.py` - 自学习管理
- ✅ `ai_audit_agent.py` - AI审计Agent
- ✅ `start_learning.bat`
- ✅ `start_monitor.bat`
- ✅ `start_ai_agent.bat`
- ✅ `start_api.bat`
- ✅ `start_all.bat`
- ✅ `stop_all.bat`
- ✅ `check_status.bat`
- ✅ `start_one_click.bat`

### 冗余文档
- ✅ `GUI改进说明.md` - 已整合到新功能指南
- ✅ `快速开始-财务报表查看.md` - 已整合
- ✅ `错误修复说明.md` - 已整合
- ✅ `最终运行说明.md` - 已整合
- ✅ `项目完成总结.md` - 已整合
- ✅ `一键启动说明.md` - 已整合
- ✅ `DEPLOYMENT_GUIDE.txt` - 不需要
- ✅ `程序开发规则和问题处理流程.txt` - 不需要

---

## 📂 目录结构

```
DAP/
├── layer1/              # 第一层: 数据接入与标准化
├── layer2/              # 第二层: 存储与数据管理
├── layer3/              # 第三层: 审计规则引擎
├── layer4/              # 第四层: 分析与输出服务
├── layer5/              # 第五层: 外部集成与API
├── utils/               # 工具模块
├── config/              # 配置文件
├── data/                # 数据库文件
├── exports/             # 导出文件
├── logs/                # 日志文件(自动生成)
├── dap_env/             # 虚拟环境(可选)
│
├── main_engine.py       # 核心引擎
├── dap_launcher.py      # GUI启动器
├── gui_financial_viewer.py  # 财务报表查看器
│
├── start_gui.bat        # 启动GUI
├── start_cli.bat        # 启动CLI
├── install.bat          # 安装依赖
├── fix_dependencies.bat # 修复依赖
│
├── requirements.txt     # 依赖列表
├── README.md            # 项目说明
├── README_新功能使用指南.md  # 使用指南⭐
├── CLAUDE.md            # 开发指南
└── AGENTS.md            # Agent配置
```

---

## 🚀 快速开始

### 1. 首次运行

```bash
# 方法A: 安装完整依赖(推荐)
install.bat

# 方法B: 只安装轻量模式依赖(快速)
fix_dependencies.bat
```

### 2. 启动系统

```bash
# 启动GUI界面(推荐)
start_gui.bat

# 或启动CLI模式
start_cli.bat
```

### 3. 使用财务报表查看功能

1. 导入数据文件(拖拽或选择)
2. 等待处理完成
3. 切换到"数据管理"标签页
4. 点击"📊 财务报表查看"按钮
5. 选择报表类型和会计期间
6. 开始分析!

---

## 📊 核心功能

### 1. 数据导入
- 支持Excel (.xlsx, .xls)
- 支持CSV (.csv)
- 支持数据库备份 (.bak, .sql, .db)
- 拖拽导入,一键处理

### 2. 财务报表查看 ⭐
- **凭证查询**: 显示10,000条凭证(解决只显示3条的问题)
- **科目余额表**: 期初、发生额、期末余额
- **资产负债表**: 资产、负债、权益分类 (新增)
- **利润表**: 收入、费用、净利润 (新增)
- **现金流量表**: 经营、投资、筹资活动 (新增)
- **科目明细账**: 科目详细交易记录

### 3. 智能模式切换
- **轻量模式**: Excel/CSV文件,快速启动
- **完整模式**: 文件夹、压缩包、AI分析
- 自动检测并提示升级

### 4. 专业界面
- 类似金蝶/用友的界面体验
- 多标签页展示
- 实时数据刷新
- Excel导出功能

---

## 💡 系统特点

✅ **GUI界面** - 图形化操作,简单直观
✅ **拖拽导入** - 一键导入,无需配置
✅ **完整报表** - 6种专业财务报表
✅ **智能切换** - 自动选择运行模式
✅ **专业体验** - 类似金蝶/用友界面
✅ **项目管理** - 多项目数据隔离
✅ **Excel导出** - 所有报表可导出

---

## 📖 详细文档

请查看: **README_新功能使用指南.md**
- 6种报表详解
- 使用场景说明
- 常见问题解答
- 提示与技巧

---

## 🆘 获取帮助

### 启动问题
```bash
# 重新安装依赖
pip install --upgrade rarfile openpyxl pandas pydantic

# 检查Python版本
python --version  # 需要 >= 3.8
```

### 数据问题
- 使用"数据管理" → "查看数据表"检查原始数据
- 确保数据包含财务字段(科目编码、科目名称、金额)

### 升级到完整模式
```bash
pip install rarfile py7zr
# 重启系统即可
```

---

**版本**: v1.2.0 - 清理优化版
**更新**: 2025-10-24
**状态**: ✅ 生产可用
