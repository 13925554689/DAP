# 审计底稿与审计报告编号区分优化方案

## 一、编号体系设计原则

### 1. 核心原则
- **清晰区分**: 底稿与报告一眼可区分
- **逻辑性强**: 符合审计工作流程
- **国际惯例**: 参考四大和国内头部事务所
- **可扩展性**: 支持未来新类型文档
- **检索友好**: 便于快速定位和归档

### 2. 参考标准
- 《中国注册会计师审计准则》索引号规范
- 鼎信诺、中普等主流审计软件编号体系
- 四大会计师事务所底稿编号惯例

---

## 二、推荐编号方案

### 方案A: 前缀区分法 (推荐 ⭐⭐⭐⭐⭐)

#### 审计底稿编号规则
```
格式: WP-{类别}-{序号}-{子序号}

示例:
WP-A-01        货币资金审定表 (Workpaper-Asset-01)
WP-A-01-01     库存现金盘点表
WP-A-01-02     银行存款函证
WP-B-01        应收账款审定表 (Workpaper-B-01)
WP-L-AA-01     应付账款审定表 (Workpaper-Liability-AA-01)
WP-PL-01       营业收入审定表 (Workpaper-P&L-01)
WP-M-01        项目风险评估备忘录 (Workpaper-Memo-01)
```

#### 审计报告编号规则
```
格式: AR-{报告类型}-{年度}-{序号}

示例:
AR-STD-2024-001   标准审计报告 (Audit Report-Standard-2024-001)
AR-IPO-2024-001   IPO审计报告
AR-TAX-2024-001   税务审计报告
AR-SPC-2024-001   专项审计报告 (Special Purpose)
AR-INT-2024-001   内部控制审计报告 (Internal Control)
```

#### 底稿类别代码表
| 代码 | 类别 | 英文 | 说明 |
|------|------|------|------|
| A | 资产类 | Asset | 货币资金、应收账款、存货、固定资产等 |
| B | 特殊资产 | Special Asset | 长期股权投资、无形资产、商誉等 |
| L | 负债类 | Liability | 应付账款、借款、应付职工薪酬等 |
| E | 权益类 | Equity | 实收资本、资本公积、盈余公积等 |
| PL | 损益类 | P&L | 收入、成本、费用 |
| CF | 现金流量 | Cash Flow | 现金流量表相关底稿 |
| M | 备忘录 | Memo | 审计计划、风险评估、总结等 |
| T | 测试类 | Test | 穿行测试、控制测试、抽样测试 |
| C | 合并类 | Consolidation | 合并报表相关底稿 |

#### 报告类型代码表
| 代码 | 类型 | 说明 |
|------|------|------|
| STD | 标准审计报告 | Standard Audit Report |
| IPO | IPO审计报告 | Initial Public Offering |
| TAX | 税务审计报告 | Tax Audit Report |
| SPC | 专项审计报告 | Special Purpose Audit |
| INT | 内控审计报告 | Internal Control Audit |
| RVW | 审阅报告 | Review Report |
| AGR | 商定程序报告 | Agreed-Upon Procedures |

---

### 方案B: 数字区间法

#### 审计底稿: 1000-8999
```
1000-1999  资产类
  1000-1099  货币资金
  1100-1199  应收账款
  1200-1299  存货
  ...

2000-2999  负债类
3000-3999  权益类
4000-4999  损益类
5000-5999  现金流量
6000-6999  合并报表
7000-7999  测试类
8000-8999  备忘录类
```

#### 审计报告: 9000-9999
```
9000-9099  标准审计报告
9100-9199  IPO审计报告
9200-9299  税务审计报告
9300-9399  专项审计报告
```

**缺点**: 数字不直观,需要记忆对照表

---

### 方案C: 混合编号法

#### 完整编号格式
```
{项目编号}-{文档类型}-{类别}-{序号}

示例:
IPO-2024-001-WP-A-01    某IPO项目的资产类底稿
IPO-2024-001-AR-STD-01  某IPO项目的审计报告
```

**优点**: 包含项目信息,便于归档
**缺点**: 编号较长

---

## 三、推荐实施方案 (方案A增强版)

### 完整编号规则

#### 1. 审计底稿 (Workpaper)
```
格式: WP-{项目年度}-{类别}-{序号}[-{子序号}]

示例:
WP-2024-A-01          2024年资产类底稿01号
WP-2024-A-01-01       子底稿01
WP-2024-PL-05         2024年损益类底稿05号
WP-2024-C-01          2024年合并类底稿01号
WP-2024-M-RISK        2024年风险评估备忘录
```

#### 2. 审计报告 (Audit Report)
```
格式: AR-{报告类型}-{年度}-{序号}

示例:
AR-STD-2024-001       2024年标准审计报告第1份
AR-IPO-2024-001       2024年IPO审计报告第1份
AR-TAX-2024-Q1-001    2024年第一季度税审报告
```

#### 3. 技术委员会文档 (Technical Committee)
```
格式: TC-{年度}-{序号}

示例:
TC-2024-001           2024年技术委员会审批文件第1份
```

#### 4. 管理建议书 (Management Letter)
```
格式: ML-{年度}-{客户编号}-{序号}

示例:
ML-2024-C001-001      2024年客户C001的管理建议书
```

---

## 四、数据库实现方案

### 1. 修改workpaper_templates表
```sql
ALTER TABLE workpaper_templates ADD COLUMN template_category VARCHAR(10);
-- 值: WP/AR/TC/ML

ALTER TABLE workpaper_templates ADD COLUMN index_prefix_type VARCHAR(10);
-- 值: A/B/L/E/PL/CF/M/T/C (底稿类别)

ALTER TABLE workpaper_templates ADD COLUMN report_type VARCHAR(10);
-- 值: STD/IPO/TAX/SPC/INT (报告类型,仅AR使用)
```

### 2. 自动编号生成函数
```python
def generate_workpaper_code(year: int, category: str, sequence: int) -> str:
    """
    生成底稿编号
    Args:
        year: 年度
        category: 类别代码 (A/B/L/E/PL/CF/M/T/C)
        sequence: 序号
    Returns:
        str: 如 WP-2024-A-01
    """
    return f"WP-{year}-{category}-{sequence:02d}"

def generate_report_code(report_type: str, year: int, sequence: int) -> str:
    """
    生成报告编号
    Args:
        report_type: 报告类型 (STD/IPO/TAX/SPC/INT)
        year: 年度
        sequence: 序号
    Returns:
        str: 如 AR-STD-2024-001
    """
    return f"AR-{report_type}-{year}-{sequence:03d}"
```

---

## 五、界面展示建议

### 1. 底稿列表显示
```
索引号              底稿名称                    类型      状态
─────────────────────────────────────────────────────
WP-2024-A-01       货币资金审定表              审计底稿   已复核
  WP-2024-A-01-01  库存现金盘点表              子底稿     已完成
  WP-2024-A-01-02  银行存款函证                子底稿     进行中
WP-2024-B-01       长期股权投资审定表          审计底稿   草稿
WP-2024-C-01       合并报表抵消分录            审计底稿   复核中
AR-STD-2024-001    XX公司2024年审计报告        审计报告   待签字
TC-2024-001        IPO项目技术委员会审批       技术文档   已审批
```

### 2. 智能搜索
- 输入 "WP-2024-A" → 显示所有2024年资产类底稿
- 输入 "AR-IPO" → 显示所有IPO审计报告
- 输入 "货币资金" → 显示所有相关底稿

---

## 六、优缺点对比

| 方案 | 优点 | 缺点 | 推荐指数 |
|------|------|------|----------|
| 方案A (前缀法) | 清晰直观、符合国际惯例、易记 | 需要定义类别代码 | ⭐⭐⭐⭐⭐ |
| 方案B (数字区间) | 简洁、纯数字 | 不直观、需记忆 | ⭐⭐ |
| 方案C (混合法) | 信息完整 | 编号过长 | ⭐⭐⭐ |

---

## 七、实施建议

### 第一阶段 (立即实施)
1. 采用**方案A增强版**
2. 在`workpaper_templates`表中添加字段
3. 实现自动编号生成函数
4. 更新底稿模板库

### 第二阶段 (后续优化)
1. 支持事务所自定义编号规则
2. 支持多层级子底稿编号 (如 WP-2024-A-01-01-01)
3. 实现编号冲突检测和自动修正
4. 提供编号规则配置界面

---

## 八、示例完整底稿索引树

```
2024年XX公司年度审计项目
├── WP-2024-M-PLAN       审计计划
├── WP-2024-M-RISK       风险评估
├── 资产类
│   ├── WP-2024-A-01     货币资金审定表
│   │   ├── WP-2024-A-01-01  库存现金盘点
│   │   ├── WP-2024-A-01-02  银行存款函证
│   │   └── WP-2024-A-01-03  定期存款函证
│   ├── WP-2024-A-02     应收账款审定表
│   └── WP-2024-A-03     存货审定表
├── 负债类
│   ├── WP-2024-L-AA-01  应付账款审定表
│   └── WP-2024-L-BB-01  短期借款审定表
├── 损益类
│   ├── WP-2024-PL-01    营业收入审定表
│   └── WP-2024-PL-02    营业成本审定表
├── 合并报表
│   ├── WP-2024-C-01     合并范围确定
│   ├── WP-2024-C-02     抵消分录汇总
│   └── WP-2024-C-03     合并报表
├── 测试类
│   ├── WP-2024-T-01     销售循环穿行测试
│   └── WP-2024-T-02     采购循环控制测试
├── 审计报告
│   ├── AR-STD-2024-001  审计报告
│   └── ML-2024-C001-001 管理建议书
└── 技术文档
    └── TC-2024-001      技术委员会审批
```

---

请您review这个方案,认可后我立即实施!
